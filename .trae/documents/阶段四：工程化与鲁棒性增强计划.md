## 阶段四：工程化与鲁棒性增强（让应用真正好用）

这一阶段的目标是把“原型”打磨成“产品”，解决实际使用中的效率、稳定性和分发问题。

### 1. 数据批量处理（Excel 集成）
- **核心逻辑**：安装 `xlsx` 库。在 [AccountService.js](file:///c:/Users/jiefeng.lin/Desktop/Project_Auto_Fill_Forms_v3/electron/services/AccountService.js) 中增加批量写入接口。
- **前端实现**：在 [Account.vue](file:///c:/Users/jiefeng.lin/Desktop/Project_Auto_Fill_Forms_v3/src/views/account/Account.vue) 中实现 `handleBatchImport`，支持拖拽上传 Excel 模板。

### 2. 自动化引擎稳定性与反检测
- **反检测增强**：安装 `playwright-extra` 和 `stealth` 插件，绕过常见的机器人检测。
- **容错逻辑**：优化 [AutoFillService.js](file:///c:/Users/jiefeng.lin/Desktop/Project_Auto_Fill_Forms_v3/electron/services/AutoFillService.js) 的 `smartFill` 算法，增加对异步加载、Shadow DOM 和多层 Iframe 的支持。
- **失败取证**：填表失败时自动在 `userData` 目录保存页面截图，并在日志中提供查看链接。

### 3. 字段拾取器（辅助配置）
- **功能**：在配置映射规则时，点击“拾取”按钮唤起浏览器，用户点击网页元素后，程序自动回填选择器到 [Form.vue](file:///c:/Users/jiefeng.lin/Desktop/Project_Auto_Fill_Forms_v3/src/views/form/Form.vue)。

### 4. 生产环境适配与打包准备
- **路径重定向**：确保生产环境下数据库 `data.db` 始终存放在系统的 `AppData/Local`（Windows）或 `Application Support`（Mac）下，避免数据丢失。
- **打包配置**：编写 `electron-builder` 配置，解决 `better-sqlite3` 原生模块在不同平台下的编译兼容性问题。

---

**点击确认后，我将先为你安装必要的工程化依赖并开始 Excel 导入功能的开发！📊**